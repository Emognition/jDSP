/*
 *
 *  * Copyright (c) 2020 Sambit Paul
 *  *
 *  * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:
 *  *
 *  * The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
 *  *
 *  * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 */

package com.github.psambit9791.jdsp;


import com.github.psambit9791.jdsp.transform.Wavelet;
import org.apache.commons.math3.complex.Complex;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class TestWavelet {

    private double[] signal = {1.0003, -0.1876, -0.931 ,  0.5332,  0.7249, -0.8137, -0.4293,
            0.9693,  0.0711, -0.9737,  0.3371,  0.9089, -0.6114, -0.6335,
            0.8421,  0.2268, -1.1182, -0.0832,  0.8464, -0.4692, -0.7236,
            0.9668,  0.9045, -0.5044,  0.1777,  1.1745, -0.3053, -1.3719,
            -0.1669, -0.0787, -1.5103, -0.8144,  1.0282,  0.5865, -0.1208,
            1.309 ,  1.7476, -0.1137, -0.5778,  0.4877, -0.3923, -1.7997,
            -0.6399,  0.5264, -0.5437, -0.6345,  1.094 ,  0.9612, -0.5611,
            0.0504};

    private int[] widths = {1,  2,  3,  4,  5,  6,  7,  8,  9, 10};

    @Test
    public void testRickerWavelet(){
        Wavelet wR = new Wavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.cwt("ricker", 0.0);

        double[][] result = {
                {0.8147 ,0.6726 ,-1.3093 ,-0.4463 ,1.4176 ,-0.0928 ,-1.3902 ,0.6026 ,1.1516 ,-1.0436 ,-0.7593 ,1.3472 ,0.2952 ,-1.3991 ,0.2916 ,1.3317 ,-0.7985 ,-1.1132 ,1.0574 ,0.5064 ,-1.4529 ,-0.0841 ,1.5219 ,-0.2465 ,-1.0065 ,1.1382 ,1.0363 ,-1.2944 ,-0.6678 ,1.05 ,-0.5047 ,-1.7215 ,0.4632 ,1.2609 ,-0.7069 ,-0.292 ,1.8039 ,0.6035 ,-1.3261 ,0.1223 ,0.9933 ,-1.1812 ,-1.4113 ,0.9311 ,0.5677 ,-1.2604 ,0.1376 ,1.6885 ,-0.035 ,-0.8364},
                {0.4576 ,0.1542 ,-0.2044 ,-0.198 ,-0.0341 ,-0.061 ,-0.1071 ,0.0125 ,0.0562 ,-0.0396 ,0.0087 ,0.157 ,0.1191 ,0.0153 ,0.0524 ,0.0093 ,-0.2339 ,-0.3676 ,-0.3052 ,-0.2834 ,-0.2074 ,0.1623 ,0.5885 ,0.7672 ,0.8228 ,0.7782 ,0.3448 ,-0.3907 ,-0.9798 ,-1.3244 ,-1.4952 ,-1.2242 ,-0.4061 ,0.5114 ,1.1972 ,1.6897 ,1.8041 ,1.2687 ,0.3702 ,-0.4247 ,-1.076 ,-1.532 ,-1.4574 ,-0.8853 ,-0.2596 ,0.3053 ,0.8895 ,1.138 ,0.714 ,0.0026},
                {0.2821 ,0.1969 ,0.0581 ,-0.068 ,-0.1379 ,-0.1463 ,-0.1122 ,-0.0578 ,0.0021 ,0.0596 ,0.1062 ,0.1286 ,0.1103 ,0.0385 ,-0.0866 ,-0.2453 ,-0.3956 ,-0.4795 ,-0.4393 ,-0.2398 ,0.1107 ,0.5477 ,0.9554 ,1.1936 ,1.1408 ,0.7412 ,0.0394 ,-0.8129 ,-1.5878 ,-2.0442 ,-2.0054 ,-1.4245 ,-0.4142 ,0.774 ,1.8196 ,2.4296 ,2.4298 ,1.82 ,0.7752 ,-0.4101 ,-1.4132 ,-1.9796 ,-1.9931 ,-1.5025 ,-0.6994 ,0.1472 ,0.7798 ,1.0411 ,0.9285 ,0.5804},
                {0.2238 ,0.1826 ,0.1095 ,0.027 ,-0.0416 ,-0.0795 ,-0.0814 ,-0.0532 ,-0.0092 ,0.0319 ,0.0513 ,0.0342 ,-0.026 ,-0.1243 ,-0.2409 ,-0.3427 ,-0.3885 ,-0.3396 ,-0.1737 ,0.102 ,0.443 ,0.7708 ,0.9873 ,1.001 ,0.7574 ,0.2647 ,-0.3954 ,-1.0778 ,-1.6064 ,-1.821 ,-1.6265 ,-1.0281 ,-0.1403 ,0.8366 ,1.667 ,2.144 ,2.1472 ,1.6777 ,0.8577 ,-0.1047 ,-0.9745 ,-1.5548 ,-1.7382 ,-1.5292 ,-1.0322 ,-0.4114 ,0.1633 ,0.5657 ,0.7418 ,0.7108},
                {0.1934 ,0.1735 ,0.1363 ,0.0905 ,0.0456 ,0.0092 ,-0.0151 ,-0.029 ,-0.0387 ,-0.0523 ,-0.0773 ,-0.1168 ,-0.1672 ,-0.2171 ,-0.249 ,-0.2426 ,-0.181 ,-0.0572 ,0.1204 ,0.3251 ,0.5145 ,0.6374 ,0.6464 ,0.5115 ,0.2326 ,-0.1543 ,-0.5795 ,-0.9518 ,-1.1785 ,-1.1893 ,-0.9568 ,-0.5079 ,0.0779 ,0.6841 ,1.1834 ,1.4683 ,1.4772 ,1.2098 ,0.7265 ,0.133 ,-0.4465 ,-0.899 ,-1.1485 ,-1.1698 ,-0.9891 ,-0.6715 ,-0.3004 ,0.0445 ,0.3048 ,0.4521},
                {0.1831 ,0.1733 ,0.1523 ,0.123 ,0.0865 ,0.0466 ,0.0071 ,-0.0322 ,-0.072 ,-0.1097 ,-0.1428 ,-0.1696 ,-0.1846 ,-0.179 ,-0.1479 ,-0.0896 ,-0.0042 ,0.1014 ,0.2101 ,0.3011 ,0.3543 ,0.3495 ,0.2729 ,0.1267 ,-0.0717 ,-0.2941 ,-0.4992 ,-0.6461 ,-0.6975 ,-0.6302 ,-0.4456 ,-0.1684 ,0.1597 ,0.4827 ,0.7406 ,0.886 ,0.8937 ,0.7611 ,0.5113 ,0.1911 ,-0.1423 ,-0.4357 ,-0.6452 ,-0.7432 ,-0.727 ,-0.6151 ,-0.437 ,-0.2286 ,-0.028 ,0.136},
                {0.1752 ,0.1593 ,0.1404 ,0.1198 ,0.0851 ,0.0439 ,0.011 ,-0.0225 ,-0.0631 ,-0.0947 ,-0.1106 ,-0.1226 ,-0.1253 ,-0.1025 ,-0.0616 ,-0.0168 ,0.0375 ,0.0997 ,0.1452 ,0.1621 ,0.1573 ,0.123 ,0.047 ,-0.054 ,-0.1566 ,-0.2567 ,-0.3275 ,-0.3663 ,-0.3567 ,-0.2824 ,-0.1589 ,-0.0098 ,0.1573 ,0.3213 ,0.4427 ,0.5038 ,0.5075 ,0.4457 ,0.3163 ,0.1488 ,-0.0257 ,-0.1963 ,-0.3427 ,-0.4334 ,-0.4637 ,-0.4478 ,-0.3853 ,-0.2798 ,-0.1605 ,-0.0501},
                {0.1581 ,0.1214 ,0.1018 ,0.0995 ,0.0707 ,0.0365 ,0.0349 ,0.0295 ,-0.0067 ,-0.0295 ,-0.0287 ,-0.0488 ,-0.077 ,-0.0657 ,-0.0389 ,-0.0331 ,-0.0139 ,0.0323 ,0.0521 ,0.0365 ,0.0292 ,0.0157 ,-0.0421 ,-0.107 ,-0.14 ,-0.1741 ,-0.1733 ,-0.1764 ,-0.1663 ,-0.1025 ,-0.0198 ,0.0437 ,0.12 ,0.2131 ,0.2658 ,0.2733 ,0.2774 ,0.2572 ,0.1779 ,0.0814 ,0.0033 ,-0.0899 ,-0.1961 ,-0.2583 ,-0.2788 ,-0.2989 ,-0.2937 ,-0.2327 ,-0.1616 ,-0.1101},
                {0.1334 ,0.0688 ,0.0529 ,0.0815 ,0.0633 ,0.0405 ,0.0836 ,0.112 ,0.0701 ,0.0455 ,0.0543 ,0.0054 ,-0.0708 ,-0.0771 ,-0.0619 ,-0.0922 ,-0.0911 ,-0.0277 ,-0.0053 ,-0.0341 ,-0.0226 ,-0.0038 ,-0.057 ,-0.1117 ,-0.1016 ,-0.1073 ,-0.0652 ,-0.0643 ,-0.0779 ,-0.0212 ,0.0439 ,0.0493 ,0.0737 ,0.146 ,0.1664 ,0.1348 ,0.1441 ,0.1559 ,0.0912 ,0.0211 ,0.0044 ,-0.043 ,-0.1369 ,-0.175 ,-0.1672 ,-0.2008 ,-0.2253 ,-0.1687 ,-0.1112 ,-0.1037},
                {0.1077 ,0.0162 ,0.0089 ,0.0734 ,0.0669 ,0.0552 ,0.1424 ,0.199 ,0.1412 ,0.1061 ,0.1159 ,0.0312 ,-0.0956 ,-0.1134 ,-0.0996 ,-0.1542 ,-0.1551 ,-0.0574 ,-0.0212 ,-0.0578 ,-0.0258 ,0.0196 ,-0.0439 ,-0.1062 ,-0.0708 ,-0.0674 ,0.0018 ,-0.0032 ,-0.0455 ,0.0095 ,0.0719 ,0.0371 ,0.0304 ,0.1049 ,0.1116 ,0.0498 ,0.0662 ,0.1053 ,0.0407 ,-0.024 ,0.0006 ,-0.0193 ,-0.1179 ,-0.1412 ,-0.1039 ,-0.1446 ,-0.1879 ,-0.1182 ,-0.0546 ,-0.0756}
        };

        double[][] out = new double[result.length][result[0].length];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j] = out_cplx[i][j].getReal();
            }
        }

        for (int i=0; i<result.length; i++) {
            Assertions.assertArrayEquals(result[i], out[i], 0.001);
        }
    }

    @Test
    public void testMorletCWTWavelet() {
        Wavelet wR = new Wavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.cwt("morlet", 5.0);

        double[][][] result = {
                {{ -0.5775 ,  -0.3551 }, { -0.4924 ,  0.6865 }, { 0.7473 ,  0.402 }, { 0.2627 ,  -0.7942 }, { -0.8352 ,  -0.1035 }, { 0.0572 ,  0.8351 }, { 0.8225 ,  -0.2095 }, { -0.3574 ,  -0.7612 }, { -0.6862 ,  0.4837 }, { 0.605 ,  0.5623 }, { 0.4323 ,  -0.7154 }, { -0.8135 ,  -0.3114 }, { -0.1873 ,  0.8293 }, { 0.8269 ,  0.0236 }, { -0.1501 ,  -0.7821 }, { -0.7379 ,  0.356 }, { 0.5441 ,  0.7486 }, { 0.7405 ,  -0.5553 }, { -0.5552 ,  -0.5191 }, { -0.2731 ,  0.674 }, { 0.8131 ,  0.0765 }, { -0.081 ,  -0.9873 }, { -1.1064 ,  -0.0235 }, { -0.1011 ,  0.7438 }, { 0.3703 ,  -0.3362 }, { -0.8016 ,  -0.4478 }, { -0.5843 ,  0.9406 }, { 0.9784 ,  0.7277 }, { 0.7734 ,  -0.5374 }, { -0.1494 ,  -0.0047 }, { 0.7496 ,  0.7227 }, { 1.328 ,  -0.5256 }, { -0.1978 ,  -1.2083 }, { -0.9426 ,  0.0257 }, { -0.0196 ,  0.2242 }, { -0.4041 ,  -0.8349 }, { -1.6422 ,  -0.179 }, { -0.7937 ,  1.1697 }, { 0.5857 ,  0.4658 }, { 0.0036 ,  -0.3699 }, { -0.2757 ,  0.6255 }, { 1.1493 ,  0.818 }, { 1.3046 ,  -0.6726 }, { -0.1711 ,  -0.7495 }, { -0.1216 ,  0.4318 }, { 0.7724 ,  -0.0883 }, { -0.2101 ,  -1.0312 }, { -1.2085 ,  0.0364 }, { -0.1368 ,  0.8448 }, { 0.3882 ,  -0.0241 }},
                {{ -0.0446 ,  -0.5392 }, { 0.49 ,  0.2922 }, { -0.4377 ,  0.292 }, { -0.1445 ,  -0.4526 }, { 0.4476 ,  -0.0522 }, { -0.0294 ,  0.4446 }, { -0.43 ,  -0.1109 }, { 0.1891 ,  -0.4024 }, { 0.3592 ,  0.2614 }, { -0.3237 ,  0.3044 }, { -0.2379 ,  -0.3755 }, { 0.4128 ,  -0.1637 }, { 0.0832 ,  0.4368 }, { -0.444 ,  -0.0 }, { 0.0832 ,  -0.4369 }, { 0.4129 ,  0.1637 }, { -0.2379 ,  0.3756 }, { -0.3237 ,  -0.3043 }, { 0.3591 ,  -0.2613 }, { 0.1889 ,  0.4024 }, { -0.4302 ,  0.1106 }, { -0.028 ,  -0.444 }, { 0.4405 ,  0.0555 }, { -0.1371 ,  0.4227 }, { -0.3888 ,  -0.2144 }, { 0.2834 ,  -0.3426 }, { 0.2833 ,  0.3429 }, { -0.3889 ,  0.2147 }, { -0.1373 ,  -0.4225 }, { 0.4401 ,  -0.0554 }, { -0.0284 ,  0.4439 }, { -0.4305 ,  -0.1109 }, { 0.1888 ,  -0.4029 }, { 0.3593 ,  0.2608 }, { -0.3233 ,  0.304 }, { -0.2373 ,  -0.3757 }, { 0.4134 ,  -0.1635 }, { 0.0836 ,  0.4373 }, { -0.4439 ,  0.0006 }, { 0.0829 ,  -0.4363 }, { 0.4123 ,  0.164 }, { -0.2384 ,  0.3754 }, { -0.324 ,  -0.3047 }, { 0.3585 ,  -0.2619 }, { 0.1917 ,  0.4004 }, { -0.4347 ,  0.1229 }, { -0.0406 ,  -0.4894 }, { 0.546 ,  0.1308 }, { -0.4104 ,  0.4445 }, { -0.079 ,  -0.5442 }},
                {{ 0.722 ,  -0.5626 }, { 0.5657 ,  0.9629 }, { -1.1867 ,  0.49 }, { -0.3374 ,  -1.3656 }, { 1.4811 ,  -0.1228 }, { -0.1318 ,  1.5257 }, { -1.5005 ,  -0.4036 }, { 0.6729 ,  -1.4114 }, { 1.2661 ,  0.9238 }, { -1.1442 ,  1.073 }, { -0.8405 ,  -1.3247 }, { 1.4585 ,  -0.5776 }, { 0.2939 ,  1.5407 }, { -1.5686 ,  -0.0004 }, { 0.2944 ,  -1.5413 }, { 1.4593 ,  0.5775 }, { -0.8399 ,  1.3251 }, { -1.1433 ,  -1.0729 }, { 1.2688 ,  -0.9209 }, { 0.6668 ,  1.4204 }, { -1.5213 ,  0.3902 }, { -0.1003 ,  -1.5668 }, { 1.5555 ,  0.1944 }, { -0.4842 ,  1.4893 }, { -1.3725 ,  -0.7579 }, { 1.0034 ,  -1.2092 }, { 1.0034 ,  1.2105 }, { -1.3728 ,  0.7595 }, { -0.4854 ,  -1.4874 }, { 1.5531 ,  -0.193 }, { -0.1037 ,  1.5668 }, { -1.5246 ,  -0.3923 }, { 0.6648 ,  -1.4244 }, { 1.2694 ,  0.9161 }, { -1.1399 ,  1.0691 }, { -0.8347 ,  -1.3264 }, { 1.4645 ,  -0.5757 }, { 0.2977 ,  1.5458 }, { -1.5685 ,  0.006 }, { 0.2905 ,  -1.536 }, { 1.4533 ,  0.5785 }, { -0.8423 ,  1.3232 }, { -1.1472 ,  -1.0679 }, { 1.2446 ,  -0.9299 }, { 0.6826 ,  1.3625 }, { -1.4107 ,  0.4252 }, { -0.1831 ,  -1.3785 }, { 1.2626 ,  0.0184 }, { -0.1602 ,  1.0739 }, { -0.8401 ,  -0.2345 }},
                {{ 0.5158 ,  0.1523 }, { -0.0629 ,  0.5525 }, { -0.5404 ,  0.0152 }, { -0.0629 ,  -0.4908 }, { 0.4216 ,  -0.0723 }, { 0.0474 ,  0.3503 }, { -0.2878 ,  -0.0003 }, { 0.0573 ,  -0.2375 }, { 0.197 ,  0.1123 }, { -0.1583 ,  0.1614 }, { -0.1255 ,  -0.1925 }, { 0.2152 ,  -0.0859 }, { 0.0419 ,  0.2288 }, { -0.2355 ,  -0.004 }, { 0.0477 ,  -0.235 }, { 0.225 ,  0.0866 }, { -0.1212 ,  0.2027 }, { -0.1691 ,  -0.155 }, { 0.1897 ,  -0.1301 }, { 0.0931 ,  0.2213 }, { -0.2412 ,  0.0607 }, { -0.0277 ,  -0.2423 }, { 0.2268 ,  0.0152 }, { -0.0707 ,  0.2064 }, { -0.193 ,  -0.1293 }, { 0.1734 ,  -0.1869 }, { 0.1742 ,  0.1924 }, { -0.1927 ,  0.1378 }, { -0.0753 ,  -0.1947 }, { 0.2139 ,  -0.0048 }, { -0.0479 ,  0.2447 }, { -0.2626 ,  -0.0714 }, { 0.0798 ,  -0.2449 }, { 0.1922 ,  0.1005 }, { -0.1488 ,  0.1306 }, { -0.0892 ,  -0.2115 }, { 0.2571 ,  -0.0755 }, { 0.0686 ,  0.2623 }, { -0.2321 ,  0.0394 }, { 0.0235 ,  -0.1939 }, { 0.172 ,  0.1042 }, { -0.1758 ,  0.1675 }, { -0.1611 ,  -0.2261 }, { 0.2677 ,  -0.1362 }, { 0.0996 ,  0.3243 }, { -0.4045 ,  0.0806 }, { -0.109 ,  -0.4883 }, { 0.5367 ,  -0.1903 }, { 0.2985 ,  0.5173 }, { -0.425 ,  0.3904 }},
                {{ 0.2568 ,  0.102 }, { 0.0364 ,  0.263 }, { -0.1935 ,  0.1481 }, { -0.1967 ,  -0.0834 }, { -0.0213 ,  -0.1781 }, { 0.1154 ,  -0.0872 }, { 0.1044 ,  0.042 }, { 0.0151 ,  0.0839 }, { -0.0454 ,  0.0439 }, { -0.045 ,  -0.0078 }, { -0.0157 ,  -0.0272 }, { 0.0041 ,  -0.0192 }, { 0.0059 ,  -0.0098 }, { 0.006 ,  -0.0112 }, { 0.0157 ,  -0.0116 }, { 0.0257 ,  0.0002 }, { 0.0242 ,  0.0182 }, { 0.0116 ,  0.033 }, { -0.0098 ,  0.0406 }, { -0.0377 ,  0.0334 }, { -0.059 ,  0.005 }, { -0.0568 ,  -0.035 }, { -0.0291 ,  -0.0678 }, { 0.0153 ,  -0.0807 }, { 0.0656 ,  -0.0655 }, { 0.1024 ,  -0.0171 }, { 0.1017 ,  0.0508 }, { 0.0569 ,  0.1075 }, { -0.0152 ,  0.1282 }, { -0.0907 ,  0.1037 }, { -0.1427 ,  0.0352 }, { -0.1438 ,  -0.0575 }, { -0.086 ,  -0.1348 }, { 0.0075 ,  -0.1628 }, { 0.1008 ,  -0.1317 }, { 0.1614 ,  -0.0503 }, { 0.1612 ,  0.0555 }, { 0.0926 ,  0.1388 }, { -0.0102 ,  0.1557 }, { -0.0885 ,  0.105 }, { -0.1073 ,  0.033 }, { -0.0861 ,  -0.0087 }, { -0.0798 ,  -0.0171 }, { -0.1073 ,  -0.0523 }, { -0.0933 ,  -0.1581 }, { 0.0573 ,  -0.2486 }, { 0.2823 ,  -0.1536 }, { 0.3437 ,  0.1444 }, { 0.0975 ,  0.3908 }, { -0.2654 ,  0.3108 }},
                {{ 0.1963 ,  0.0601 }, { 0.0801 ,  0.182 }, { -0.0808 ,  0.1684 }, { -0.1646 ,  0.0432 }, { -0.1228 ,  -0.0873 }, { -0.0085 ,  -0.1296 }, { 0.0819 ,  -0.0733 }, { 0.0908 ,  0.0183 }, { 0.0328 ,  0.0727 }, { -0.0359 ,  0.0622 }, { -0.068 ,  0.0093 }, { -0.0524 ,  -0.045 }, { -0.0067 ,  -0.0718 }, { 0.0441 ,  -0.0634 }, { 0.0804 ,  -0.026 }, { 0.0901 ,  0.0282 }, { 0.0661 ,  0.0841 }, { 0.0088 ,  0.122 }, { -0.0698 ,  0.1215 }, { -0.1439 ,  0.0702 }, { -0.1801 ,  -0.0258 }, { -0.1517 ,  -0.1384 }, { -0.053 ,  -0.2238 }, { 0.0915 ,  -0.2387 }, { 0.2316 ,  -0.1604 }, { 0.308 ,  -0.0021 }, { 0.2771 ,  0.1864 }, { 0.133 ,  0.3337 }, { -0.0837 ,  0.374 }, { -0.2963 ,  0.2767 }, { -0.4203 ,  0.0642 }, { -0.3985 ,  -0.1915 }, { -0.2278 ,  -0.3944 }, { 0.0345 ,  -0.4636 }, { 0.2919 ,  -0.3683 }, { 0.4484 ,  -0.1427 }, { 0.4494 ,  0.1285 }, { 0.3021 ,  0.3491 }, { 0.0649 ,  0.4508 }, { -0.1838 ,  0.4123 }, { -0.3752 ,  0.2526 }, { -0.46 ,  0.0131 }, { -0.4045 ,  -0.2487 }, { -0.1993 ,  -0.4519 }, { 0.1108 ,  -0.5014 }, { 0.4077 ,  -0.3373 }, { 0.5368 ,  -0.0009 }, { 0.404 ,  0.3486 }, { 0.0643 ,  0.5143 }, { -0.2884 ,  0.3974 }},
                {{ 0.1682 ,  0.034 }, { 0.1016 ,  0.1317 }, { -0.0084 ,  0.1558 }, { -0.0978 ,  0.1018 }, { -0.1221 ,  0.0121 }, { -0.0827 ,  -0.0574 }, { -0.0194 ,  -0.0742 }, { 0.0226 ,  -0.0448 }, { 0.0216 ,  -0.0052 }, { -0.0095 ,  0.0071 }, { -0.035 ,  -0.0207 }, { -0.0223 ,  -0.0679 }, { 0.0352 ,  -0.0966 }, { 0.1129 ,  -0.075 }, { 0.1692 ,  0.0054 }, { 0.1641 ,  0.1224 }, { 0.0784 ,  0.2286 }, { -0.0731 ,  0.2702 }, { -0.2418 ,  0.2108 }, { -0.3608 ,  0.0483 }, { -0.369 ,  -0.1782 }, { -0.2353 ,  -0.3927 }, { 0.0205 ,  -0.5064 }, { 0.3239 ,  -0.4532 }, { 0.5665 ,  -0.2209 }, { 0.6448 ,  0.1354 }, { 0.5009 ,  0.5015 }, { 0.1555 ,  0.7408 }, { -0.2907 ,  0.7478 }, { -0.6865 ,  0.4926 }, { -0.8826 ,  0.04 }, { -0.7903 ,  -0.4652 }, { -0.4219 ,  -0.8464 }, { 0.1093 ,  -0.9628 }, { 0.6275 ,  -0.7625 }, { 0.9544 ,  -0.3024 }, { 0.9733 ,  0.2685 }, { 0.6719 ,  0.7592 }, { 0.1474 ,  1.003 }, { -0.4263 ,  0.9153 }, { -0.855 ,  0.5227 }, { -0.9886 ,  -0.0425 }, { -0.7783 ,  -0.5815 }, { -0.3012 ,  -0.8987 }, { 0.2625 ,  -0.8789 }, { 0.6963 ,  -0.5382 }, { 0.8352 ,  -0.0227 }, { 0.6409 ,  0.4509 }, { 0.221 ,  0.6913 }, { -0.2247 ,  0.6235 }},
                {{ 0.1696 ,  0.017 }, { 0.1287 ,  0.1088 }, { 0.0469 ,  0.16 }, { -0.043 ,  0.1575 }, { -0.1148 ,  0.1093 }, { -0.1492 ,  0.037 }, { -0.1425 ,  -0.0354 }, { -0.1095 ,  -0.0928 }, { -0.0643 ,  -0.1333 }, { -0.0061 ,  -0.1586 }, { 0.0677 ,  -0.1639 }, { 0.1493 ,  -0.1366 }, { 0.224 ,  -0.0636 }, { 0.2663 ,  0.059 }, { 0.2382 ,  0.2133 }, { 0.1133 ,  0.3529 }, { -0.0953 ,  0.4164 }, { -0.3357 ,  0.3523 }, { -0.5312 ,  0.1438 }, { -0.5947 ,  -0.1744 }, { -0.462 ,  -0.513 }, { -0.1356 ,  -0.7514 }, { 0.3054 ,  -0.7813 }, { 0.7298 ,  -0.5504 }, { 0.9872 ,  -0.0909 }, { 0.9549 ,  0.4759 }, { 0.6019 ,  0.9704 }, { 0.0002 ,  1.2124 }, { -0.6751 ,  1.0872 }, { -1.2008 ,  0.5966 }, { -1.3899 ,  -0.1305 }, { -1.1535 ,  -0.8742 }, { -0.5342 ,  -1.3906 }, { 0.2891 ,  -1.4957 }, { 1.0532 ,  -1.1349 }, { 1.5079 ,  -0.4095 }, { 1.5022 ,  0.4553 }, { 1.0287 ,  1.1824 }, { 0.2357 ,  1.5348 }, { -0.6137 ,  1.4004 }, { -1.2401 ,  0.8333 }, { -1.4502 ,  0.032 }, { -1.1936 ,  -0.7317 }, { -0.5767 ,  -1.208 }, { 0.1698 ,  -1.2579 }, { 0.7822 ,  -0.9009 }, { 1.0703 ,  -0.2979 }, { 0.9766 ,  0.32 }, { 0.5793 ,  0.7411 }, { 0.0574 ,  0.8488 }},
                {{ 0.1794 ,  0.0366 }, { 0.1418 ,  0.1247 }, { 0.0576 ,  0.188 }, { -0.0538 ,  0.2045 }, { -0.1592 ,  0.1548 }, { -0.2271 ,  0.0538 }, { -0.2394 ,  -0.0659 }, { -0.1875 ,  -0.1842 }, { -0.0733 ,  -0.2761 }, { 0.0815 ,  -0.3013 }, { 0.2402 ,  -0.2397 }, { 0.3628 ,  -0.1033 }, { 0.4092 ,  0.0909 }, { 0.344 ,  0.3125 }, { 0.1576 ,  0.4936 }, { -0.1201 ,  0.5597 }, { -0.4262 ,  0.4724 }, { -0.6747 ,  0.2252 }, { -0.7713 ,  -0.1546 }, { -0.6476 ,  -0.5753 }, { -0.2982 ,  -0.8984 }, { 0.2095 ,  -1.0061 }, { 0.7475 ,  -0.8333 }, { 1.1517 ,  -0.3757 }, { 1.2693 ,  0.2764 }, { 1.0213 ,  0.9369 }, { 0.4347 ,  1.4001 }, { -0.3498 ,  1.5084 }, { -1.1158 ,  1.1847 }, { -1.6273 ,  0.4747 }, { -1.7031 ,  -0.4311 }, { -1.289 ,  -1.2654 }, { -0.4825 ,  -1.7836 }, { 0.4966 ,  -1.8184 }, { 1.365 ,  -1.3296 }, { 1.8594 ,  -0.4498 }, { 1.8272 ,  0.5544 }, { 1.2807 ,  1.3917 }, { 0.3865 ,  1.8271 }, { -0.5881 ,  1.7339 }, { -1.3531 ,  1.1519 }, { -1.6919 ,  0.2853 }, { -1.5331 ,  -0.5922 }, { -0.9616 ,  -1.2343 }, { -0.1772 ,  -1.472 }, { 0.5704 ,  -1.2653 }, { 1.0633 ,  -0.7298 }, { 1.1892 ,  -0.0721 }, { 0.965 ,  0.5058 }, { 0.5085 ,  0.8517 }},
                {{ 0.1533 ,  0.0734 }, { 0.1105 ,  0.1519 }, { 0.0157 ,  0.195 }, { -0.1057 ,  0.1792 }, { -0.1963 ,  0.1022 }, { -0.2353 ,  -0.0174 }, { -0.2209 ,  -0.1531 }, { -0.1281 ,  -0.2686 }, { 0.0406 ,  -0.319 }, { 0.2228 ,  -0.2746 }, { 0.362 ,  -0.135 }, { 0.4318 ,  0.0778 }, { 0.3879 ,  0.3192 }, { 0.1962 ,  0.5189 }, { -0.1003 ,  0.6029 }, { -0.417 ,  0.5254 }, { -0.6848 ,  0.2778 }, { -0.8217 ,  -0.106 }, { -0.7354 ,  -0.5401 }, { -0.4098 ,  -0.901 }, { 0.0784 ,  -1.0714 }, { 0.625 ,  -0.9737 }, { 1.1029 ,  -0.5892 }, { 1.3473 ,  0.0196 }, { 1.2411 ,  0.7077 }, { 0.791 ,  1.2898 }, { 0.0668 ,  1.59 }, { -0.7372 ,  1.4955 }, { -1.4148 ,  0.9989 }, { -1.7903 ,  0.2 }, { -1.723 ,  -0.7094 }, { -1.1885 ,  -1.4855 }, { -0.3289 ,  -1.9095 }, { 0.6305 ,  -1.8585 }, { 1.4597 ,  -1.3339 }, { 1.9348 ,  -0.4628 }, { 1.9054 ,  0.5249 }, { 1.3924 ,  1.3636 }, { 0.5584 ,  1.8382 }, { -0.3852 ,  1.839 }, { -1.2007 ,  1.3814 }, { -1.6619 ,  0.6062 }, { -1.6665 ,  -0.2607 }, { -1.2702 ,  -0.9878 }, { -0.6072 ,  -1.4042 }, { 0.1465 ,  -1.4322 }, { 0.7763 ,  -1.1031 }, { 1.1183 ,  -0.5476 }, { 1.1395 ,  0.0585 }, { 0.8918 ,  0.5565 }}
        };

        double[][][] out = new double[result.length][result[0].length][2];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j][0] = out_cplx[i][j].getReal();
                out[i][j][1] = out_cplx[i][j].getImaginary();
            }
        }

        for (int i=0; i<result.length; i++) {
            for (int j=0; j<result[0].length; j++) {
                Assertions.assertArrayEquals(result[i][j], out[i][j], 0.001);
            }
        }

    }

    @Test
    public void testPaulWavelet() {
        Wavelet wR = new Wavelet(this.signal, this.widths);
        Complex[][] out_cplx = wR.cwt("paul", 4.0);

        double[][][] result = {
                {{ -0.427574067 ,  -0.466169535 }, { -0.347068167 ,  0.487716644 }, { 0.490731218 ,  0.312963228 }, { 0.174218774 ,  -0.617200196 }, { -0.549104863 ,  -0.0809444151 }, { 0.0385782458 ,  0.648648783 }, { 0.542335694 ,  -0.16185219 }, { -0.235508287 ,  -0.588994218 }, { -0.453468773 ,  0.379714076 }, { 0.394902333 ,  0.441772076 }, { 0.279211245 ,  -0.551530862 }, { -0.542239108 ,  -0.24075336 }, { -0.128798539 ,  0.639721783 }, { 0.543073785 ,  0.00611317964 }, { -0.0930804125 ,  -0.627200976 }, { -0.470753953 ,  0.253332124 }, { 0.382676474 ,  0.561885753 }, { 0.51713049 ,  -0.438046379 }, { -0.338882222 ,  -0.387792684 }, { -0.166573388 ,  0.565650228 }, { 0.524746585 ,  0.124220391 }, { -0.0945072326 ,  -0.693430232 }, { -0.798495868 ,  0.0419252351 }, { -0.153262756 ,  0.599625155 }, { 0.161762031 ,  -0.29704578 }, { -0.579293116 ,  -0.445941168 }, { -0.382172381 ,  0.586028161 }, { 0.713014545 ,  0.408765192 }, { 0.638446513 ,  -0.540026891 }, { 0.0663166124 ,  -0.0489529273 }, { 0.654452779 ,  0.618571881 }, { 0.987760982 ,  -0.252704375 }, { -0.0996395059 ,  -0.71954067 }, { -0.687339263 ,  0.245029293 }, { -0.165278002 ,  0.342044634 }, { -0.468567422 ,  -0.586604781 }, { -1.28392035 ,  -0.201113205 }, { -0.675067121 ,  0.740880615 }, { 0.319063573 ,  0.136848779 }, { 0.0329874405 ,  -0.50649821 }, { -0.0683454768 ,  0.330299856 }, { 0.917615066 ,  0.578387112 }, { 1.02379968 ,  -0.477218054 }, { 0.0164553547 ,  -0.459742881 }, { -0.0113694807 ,  0.492082138 }, { 0.51129084 ,  0.076137698 }, { -0.190245392 ,  -0.702802659 }, { -0.879385918 ,  0.0657549107 }, { -0.160218545 ,  0.6331433 }, { 0.23187304 ,  -0.33339467 }},
                {{ 0.293354239 ,  -0.673339781 }, { 0.406335476 ,  0.763242061 }, { -0.65277686 ,  0.483735988 }, { -0.22435064 ,  -1.01828769 }, { 0.746337336 ,  -0.134048316 }, { -0.0453646422 ,  1.06202535 }, { -0.724733906 ,  -0.26381129 }, { 0.317864615 ,  -0.962079419 }, { 0.60396096 ,  0.624233278 }, { -0.547446719 ,  0.725585438 }, { -0.402291541 ,  -0.901617038 }, { 0.696189747 ,  -0.395473328 }, { 0.143065537 ,  1.04208063 }, { -0.742924005 ,  0.000908495713 }, { 0.147382321 ,  -1.03858901 }, { 0.702547819 ,  0.402949247 }, { -0.397612497 ,  0.912674021 }, { -0.548213717 ,  -0.714598527 }, { 0.59544227 ,  -0.619214667 }, { 0.302537855 ,  0.954939806 }, { -0.742960395 ,  0.241413487 }, { -0.0609219273 ,  -1.09716662 }, { 0.738904012 ,  0.0940495317 }, { -0.220791635 ,  0.982367948 }, { -0.632219243 ,  -0.517488119 }, { 0.507593846 ,  -0.792316811 }, { 0.504667832 ,  0.877024249 }, { -0.641378607 ,  0.58685304 }, { -0.236612686 ,  -0.942463819 }, { 0.717568993 ,  -0.0942340396 }, { -0.0837651414 ,  1.05311375 }, { -0.76070007 ,  -0.323099287 }, { 0.296976871 ,  -1.05706869 }, { 0.606364348 ,  0.521908053 }, { -0.521994808 ,  0.648753767 }, { -0.363406521 ,  -0.927600795 }, { 0.733422869 ,  -0.36183429 }, { 0.163783916 ,  1.1239134 }, { -0.74746928 ,  0.103197624 }, { 0.118564397 ,  -0.949864728 }, { 0.659995886 ,  0.450117253 }, { -0.438041019 ,  0.906374291 }, { -0.57087808 ,  -0.766890878 }, { 0.59955357 ,  -0.694031432 }, { 0.331822211 ,  0.887707841 }, { -0.700092783 ,  0.206117745 }, { -0.0221781224 ,  -1.09298159 }, { 0.757869061 ,  0.118722718 }, { -0.193891304 ,  0.972468557 }, { -0.383685458 ,  -0.458782473 }},
                {{ 0.569067732 ,  -0.381074123 }, { 0.437536848 ,  0.801476787 }, { -0.899754861 ,  0.422488014 }, { -0.301388352 ,  -0.963518695 }, { 0.955735943 ,  -0.135209218 }, { -0.0567198539 ,  0.974168395 }, { -0.928268362 ,  -0.243784755 }, { 0.404827138 ,  -0.887205098 }, { 0.770983456 ,  0.571316606 }, { -0.701033056 ,  0.66210863 }, { -0.511141119 ,  -0.838236384 }, { 0.900804082 ,  -0.372059318 }, { 0.197824476 ,  0.955518696 }, { -0.934487743 ,  0.00481018687 }, { 0.201610473 ,  -0.941736813 }, { 0.901312219 ,  0.395758575 }, { -0.524961664 ,  0.870217515 }, { -0.737580781 ,  -0.632587235 }, { 0.712003575 ,  -0.561201288 }, { 0.335302095 ,  0.861634825 }, { -0.985976472 ,  0.174740797 }, { -0.075875233 ,  -1.08038514 }, { 0.996978438 ,  0.0122957259 }, { -0.185808948 ,  0.851771207 }, { -0.687184995 ,  -0.482956101 }, { 0.76222892 ,  -0.675947207 }, { 0.707904001 ,  0.91607859 }, { -0.841624692 ,  0.677810485 }, { -0.414434513 ,  -0.742637039 }, { 0.73707156 ,  -0.0175370626 }, { -0.311446868 ,  0.952763382 }, { -1.13928163 ,  -0.40462636 }, { 0.308895518 ,  -1.14440251 }, { 0.827773829 ,  0.295377631 }, { -0.503291561 ,  0.455597476 }, { -0.232160846 ,  -0.907062125 }, { 1.17206396 ,  -0.280069501 }, { 0.37455858 ,  1.17671635 }, { -0.905905914 ,  0.280221344 }, { 0.0800873776 ,  -0.703427327 }, { 0.679136829 ,  0.521671479 }, { -0.765699094 ,  0.851181214 }, { -0.913697661 ,  -0.776055933 }, { 0.65417264 ,  -0.765692965 }, { 0.401740185 ,  0.675778831 }, { -0.836386795 ,  0.0706199128 }, { 0.0915775609 ,  -1.08379794 }, { 1.14250295 ,  0.079688123 }, { -0.0185434077 ,  0.994829944 }, { -0.598925809 ,  -0.0102998828 }},
                {{ 0.561046358 ,  -0.11228429 }, { 0.250986262 ,  0.660242381 }, { -0.658910469 ,  0.301855078 }, { -0.239942237 ,  -0.617109643 }, { 0.589952673 ,  -0.105166923 }, { -0.0410646182 ,  0.592716918 }, { -0.592376096 ,  -0.160086029 }, { 0.253228205 ,  -0.56007041 }, { 0.486469765 ,  0.344182894 }, { -0.443377792 ,  0.396954173 }, { -0.314436576 ,  -0.53743915 }, { 0.592133313 ,  -0.243110427 }, { 0.154751884 ,  0.594238169 }, { -0.561453793 ,  0.0212670146 }, { 0.150703563 ,  -0.546175457 }, { 0.571844064 ,  0.302353145 }, { -0.367511868 ,  0.600073012 }, { -0.539121544 ,  -0.353594247 }, { 0.355003791 ,  -0.351481483 }, { 0.115587145 ,  0.474732146 }, { -0.687523966 ,  -0.0114418229 }, { -0.0395808282 ,  -0.828719892 }, { 0.731833091 ,  -0.141997018 }, { 0.0646985486 ,  0.441485353 }, { -0.209460361 ,  -0.28025248 }, { 0.688956849 ,  -0.271194836 }, { 0.559895179 ,  0.827990683 }, { -0.573647882 ,  0.726118238 }, { -0.467075089 ,  -0.201267048 }, { 0.138311196 ,  0.115958676 }, { -0.565711757 ,  0.527689579 }, { -1.01978401 ,  -0.509945336 }, { 0.0683533225 ,  -1.10179622 }, { 0.617500112 ,  -0.22869588 }, { -0.0242908889 ,  -0.0286709518 }, { 0.268931328 ,  -0.680221421 }, { 1.16020067 ,  -0.0582156865 }, { 0.532706654 ,  1.04399067 }, { -0.483333267 ,  0.5866687 }, { -0.0776367336 ,  -0.0479180787 }, { 0.133218005 ,  0.58197276 }, { -0.855762342 ,  0.592811328 }, { -0.91172951 ,  -0.612948344 }, { 0.208944241 ,  -0.743845523 }, { 0.216092655 ,  0.102897486 }, { -0.408978336 ,  -0.23583878 }, { 0.304062428 ,  -0.847847617 }, { 1.04345521 ,  0.046097062 }, { 0.246110876 ,  0.864861314 }, { -0.466822919 ,  0.348431453 }},
                {{ 0.449317056 ,  0.0238499878 }, { 0.150330045 ,  0.470526744 }, { -0.380121809 ,  0.2325621 }, { -0.185530386 ,  -0.274797652 }, { 0.233547249 ,  -0.0651720669 }, { -0.0420509446 ,  0.258030087 }, { -0.291636393 ,  -0.0939628888 }, { 0.110929757 ,  -0.282383513 }, { 0.226731827 ,  0.139075637 }, { -0.200477759 ,  0.16127216 }, { -0.125789997 ,  -0.275212863 }, { 0.315778398 ,  -0.12599275 }, { 0.120317746 ,  0.288732392 }, { -0.219109597 ,  0.0493721897 }, { 0.0944622887 ,  -0.186942237 }, { 0.251468269 ,  0.230082476 }, { -0.244780137 ,  0.363882429 }, { -0.378297674 ,  -0.123610717 }, { 0.0126699524 ,  -0.195419737 }, { -0.0854423896 ,  0.100907714 }, { -0.393664207 ,  -0.210573915 }, { 0.0296777933 ,  -0.635398642 }, { 0.533565392 ,  -0.283132314 }, { 0.339542854 ,  0.102639316 }, { 0.260687928 ,  -0.0587984009 }, { 0.628701006 ,  0.143637784 }, { 0.403060645 ,  0.815660651 }, { -0.372572353 ,  0.820124778 }, { -0.576315129 ,  0.29664628 }, { -0.475460486 ,  0.223113522 }, { -0.850685612 ,  0.112752454 }, { -0.937450887 ,  -0.671696363 }, { -0.151605798 ,  -1.14555196 }, { 0.45363244 ,  -0.760966843 }, { 0.468676734 ,  -0.504001503 }, { 0.794903158 ,  -0.501222625 }, { 1.21379926 ,  0.154131888 }, { 0.73001246 ,  0.980163107 }, { -0.0649654033 ,  0.928119732 }, { -0.221647232 ,  0.604121555 }, { -0.397037706 ,  0.702650862 }, { -0.988793824 ,  0.408351191 }, { -0.969814996 ,  -0.464916962 }, { -0.255085341 ,  -0.753930358 }, { 0.0123828124 ,  -0.450079301 }, { -0.0171040745 ,  -0.556788613 }, { 0.516691623 ,  -0.664358782 }, { 0.934008993 ,  0.028318917 }, { 0.422067643 ,  0.690792455 }, { -0.228561814 ,  0.517494283 }},
                {{ 0.346171692 ,  0.0645988053 }, { 0.124682341 ,  0.327534463 }, { -0.188094316 ,  0.209067814 }, { -0.148237125 ,  -0.0562912909 }, { 0.0259151488 ,  -0.0226005296 }, { -0.0608243758 ,  0.0817054202 }, { -0.141017944 ,  -0.0644738457 }, { 0.0300826395 ,  -0.142683331 }, { 0.0891060593 ,  0.0191671087 }, { -0.0611827256 ,  0.0285440149 }, { -0.012673979 ,  -0.133600409 }, { 0.176827016 ,  -0.0550396961 }, { 0.1068499 ,  0.139267385 }, { -0.0379331468 ,  0.0842287409 }, { 0.0485793572 ,  0.0255735444 }, { 0.0510323296 ,  0.202342256 }, { -0.213023222 ,  0.233149972 }, { -0.324496618 ,  -0.0222904895 }, { -0.193623955 ,  -0.152642762 }, { -0.193663835 ,  -0.153906995 }, { -0.206119296 ,  -0.371095859 }, { 0.123252569 ,  -0.568962421 }, { 0.500490486 ,  -0.367170853 }, { 0.563848185 ,  -0.0496683097 }, { 0.572516226 ,  0.128224158 }, { 0.617477608 ,  0.460871452 }, { 0.292666844 ,  0.908603353 }, { -0.33627443 ,  0.952080559 }, { -0.742142873 ,  0.606027855 }, { -0.925792515 ,  0.268105348 }, { -1.10806833 ,  -0.17863685 }, { -0.956725872 ,  -0.869596446 }, { -0.278100579 ,  -1.29980044 }, { 0.417762195 ,  -1.16992131 }, { 0.83769741 ,  -0.846655085 }, { 1.20967759 ,  -0.436305457 }, { 1.37338481 ,  0.29902156 }, { 0.939305568 ,  1.03108465 }, { 0.213787618 ,  1.23266321 }, { -0.306653774 ,  1.08394778 }, { -0.745928674 ,  0.8754982 }, { -1.16108587 ,  0.373140313 }, { -1.11389239 ,  -0.376050205 }, { -0.601958731 ,  -0.801745647 }, { -0.154446867 ,  -0.822997876 }, { 0.183221469 ,  -0.807433849 }, { 0.646526464 ,  -0.62022231 }, { 0.8840412 ,  -0.0216585862 }, { 0.536312537 ,  0.528126663 }, { -0.000602702684 ,  0.55228682 }},
                {{ 0.277055668 ,  0.0657743754 }, { 0.12666064 ,  0.237747287 }, { -0.0746979627 ,  0.198201493 }, { -0.115197141 ,  0.0581254731 }, { -0.065041902 ,  0.0174172215 }, { -0.0814151166 ,  0.017642413 }, { -0.0891596945 ,  -0.0525665384 }, { -0.0097068348 ,  -0.089504618 }, { 0.0322790091 ,  -0.0370108408 }, { 0.00377130946 ,  -0.0291288835 }, { 0.0427538994 ,  -0.0691642898 }, { 0.123448761 ,  -0.0132778284 }, { 0.099576063 ,  0.0931851635 }, { 0.0264361743 ,  0.116452824 }, { 0.00593653187 ,  0.12719472 }, { -0.0648684317 ,  0.19048266 }, { -0.232468586 ,  0.160594132 }, { -0.326575764 ,  -0.0152408214 }, { -0.286990896 ,  -0.183729605 }, { -0.220047146 ,  -0.313755464 }, { -0.0811722897 ,  -0.480825823 }, { 0.229048952 ,  -0.558868428 }, { 0.559939978 ,  -0.38657911 }, { 0.720894328 ,  -0.0621979458 }, { 0.738248156 ,  0.286554981 }, { 0.607138433 ,  0.686097783 }, { 0.197680191 ,  1.03100616 }, { -0.404725945 ,  1.06275575 }, { -0.914521922 ,  0.749281992 }, { -1.21573473 ,  0.253234033 }, { -1.29376664 ,  -0.376336202 }, { -1.00316182 ,  -1.05475707 }, { -0.323200887 ,  -1.4740871 }, { 0.455628563 ,  -1.4386136 }, { 1.08128692 ,  -1.05694745 }, { 1.49190004 ,  -0.432873769 }, { 1.54803176 ,  0.382012048 }, { 1.11586437 ,  1.1163349 }, { 0.385188794 ,  1.45494415 }, { -0.332511856 ,  1.39252282 }, { -0.928059446 ,  1.04694042 }, { -1.30508024 ,  0.430594342 }, { -1.26550553 ,  -0.305250041 }, { -0.838277311 ,  -0.829988607 }, { -0.296546582 ,  -1.02044189 }, { 0.221411045 ,  -0.969434895 }, { 0.674586318 ,  -0.663733896 }, { 0.852268004 ,  -0.116773422 }, { 0.613451106 ,  0.370843787 }, { 0.185883617 ,  0.508542807 }},
                {{ 0.234683446 ,  0.0562956694 }, { 0.13218975 ,  0.183037019 }, { -0.0110163646 ,  0.186593231 }, { -0.0836293068 ,  0.111227411 }, { -0.0920730164 ,  0.0504966205 }, { -0.0938726446 ,  0.00864212312 }, { -0.0782335157 ,  -0.0420008134 }, { -0.028601199 ,  -0.0694452531 }, { 0.0118976338 ,  -0.0571045292 }, { 0.030093847 ,  -0.0464357739 }, { 0.0651687771 ,  -0.0373525977 }, { 0.101959505 ,  0.0148696456 }, { 0.0862561565 ,  0.0911481323 }, { 0.0291788539 ,  0.138803793 }, { -0.0374887723 ,  0.164485317 }, { -0.13680326 ,  0.171994746 }, { -0.26328144 ,  0.103874495 }, { -0.335547697 ,  -0.0561810143 }, { -0.306364194 ,  -0.24269543 }, { -0.19103985 ,  -0.411135672 }, { 0.0214891612 ,  -0.539508737 }, { 0.332093486 ,  -0.544720049 }, { 0.637753134 ,  -0.351528466 }, { 0.809931142 ,  0.000147118236 }, { 0.796111549 ,  0.421123391 }, { 0.565421784 ,  0.83746521 }, { 0.0969261838 ,  1.12142794 }, { -0.509673252 ,  1.11467011 }, { -1.05320873 ,  0.777088282 }, { -1.37788761 ,  0.195149737 }, { -1.39032424 ,  -0.516643422 }, { -1.01985187 ,  -1.1929949 }, { -0.314091992 ,  -1.59950083 }, { 0.512534959 ,  -1.58236663 }, { 1.22271401 ,  -1.16146586 }, { 1.65180685 ,  -0.442053139 }, { 1.66962969 ,  0.419634959 }, { 1.23428002 ,  1.17297178 }, { 0.492208106 ,  1.57899113 }, { -0.312964629 ,  1.56353505 }, { -0.988082983 ,  1.17822085 }, { -1.37891194 ,  0.520187642 }, { -1.36813813 ,  -0.223112181 }, { -0.990277664 ,  -0.805550377 }, { -0.42373709 ,  -1.08459133 }, { 0.159359498 ,  -1.05029668 }, { 0.619040313 ,  -0.733099273 }, { 0.802440008 ,  -0.23661121 }, { 0.654928705 ,  0.212690821 }, { 0.32541934 ,  0.41855081 }},
                {{ 0.207003405 ,  0.0467459629 }, { 0.134459111 ,  0.147946081 }, { 0.0260217098 ,  0.171729778 }, { -0.0535781756 ,  0.13168071 }, { -0.0883444239 ,  0.0742294569 }, { -0.0942577768 ,  0.0200490946 }, { -0.0760563191 ,  -0.0275449574 }, { -0.0372092128 ,  -0.0549505211 }, { 0.00341786795 ,  -0.0561855346 }, { 0.0365483131 ,  -0.0429162476 }, { 0.0673122674 ,  -0.0154437583 }, { 0.0838431604 ,  0.0363899885 }, { 0.063136445 ,  0.0997482196 }, { 0.0046104925 ,  0.147054103 }, { -0.0794015336 ,  0.164799454 }, { -0.183149628 ,  0.139497939 }, { -0.283146994 ,  0.0465877446 }, { -0.32827288 ,  -0.113534034 }, { -0.27984515 ,  -0.30000572 }, { -0.130121532 ,  -0.462917049 }, { 0.114466523 ,  -0.551531147 }, { 0.418377482 ,  -0.503189592 }, { 0.693701006 ,  -0.279102241 }, { 0.83666954 ,  0.0917729383 }, { 0.777935162 ,  0.528373576 }, { 0.488307181 ,  0.925427155 }, { -0.0098281274 ,  1.15470709 }, { -0.609151678 ,  1.10058574 }, { -1.13915215 ,  0.7305955 }, { -1.43965997 ,  0.113015573 }, { -1.40228488 ,  -0.616100381 }, { -0.989041758 ,  -1.27107627 }, { -0.272891359 ,  -1.65063028 }, { 0.559425585 ,  -1.62347194 }, { 1.28300568 ,  -1.18556089 }, { 1.70855903 ,  -0.441462888 }, { 1.71450108 ,  0.425028228 }, { 1.28883484 ,  1.17846711 }, { 0.558450056 ,  1.61101656 }, { -0.263650472 ,  1.62760477 }, { -0.964848984 ,  1.25400335 }, { -1.3755505 ,  0.60644652 }, { -1.40279155 ,  -0.12515283 }, { -1.07610833 ,  -0.728302869 }, { -0.534081444 ,  -1.05601649 }, { 0.0489760428 ,  -1.06337989 }, { 0.509652164 ,  -0.78962261 }, { 0.722009225 ,  -0.354956515 }, { 0.657713978 ,  0.0589922335 }, { 0.417913057 ,  0.30346855 }},
                {{ 0.188034408 ,  0.0385718361 }, { 0.134491288 ,  0.122919748 }, { 0.0490988974 ,  0.155271654 }, { -0.0266534161 ,  0.136141694 }, { -0.0715180412 ,  0.0896057132 }, { -0.0850062884 ,  0.0369327999 }, { -0.0719838438 ,  -0.00881949228 }, { -0.040312785 ,  -0.0369486938 }, { -0.0025128052 ,  -0.0426895402 }, { 0.0316450292 ,  -0.028564212 }, { 0.0561510322 ,  0.00376223674 }, { 0.0603977907 ,  0.0523399781 }, { 0.0324016989 ,  0.104815234 }, { -0.0292705404 ,  0.140992232 }, { -0.115377945 ,  0.142997524 }, { -0.209905419 ,  0.0955955472 }, { -0.284487115 ,  -0.0115034641 }, { -0.300273244 ,  -0.168854329 }, { -0.226732491 ,  -0.340966943 }, { -0.0557979018 ,  -0.477764832 }, { 0.19548865 ,  -0.525193772 }, { 0.47877738 ,  -0.434836745 }, { 0.713685118 ,  -0.187457172 }, { 0.811669506 ,  0.185122014 }, { 0.708987238 ,  0.603287987 }, { 0.386998568 ,  0.95771615 }, { -0.113204244 ,  1.13055346 }, { -0.683131078 ,  1.03142201 }, { -1.16962629 ,  0.640204062 }, { -1.42400013 ,  0.0235253485 }, { -1.34630444 ,  -0.680377382 }, { -0.916574708 ,  -1.2908137 }, { -0.215642416 ,  -1.63034993 }, { 0.585994057 ,  -1.58597395 }, { 1.28042861 ,  -1.15115093 }, { 1.68449559 ,  -0.426115652 }, { 1.6876091 ,  0.408459632 }, { 1.28674098 ,  1.13585696 }, { 0.594517017 ,  1.56902944 }, { -0.198820442 ,  1.61099066 }, { -0.888447804 ,  1.27537487 }, { -1.30882704 ,  0.672681525 }, { -1.37493103 ,  -0.020684989 }, { -1.10762304 ,  -0.614664175 }, { -0.620874447 ,  -0.967772439 }, { -0.0746225605 ,  -1.02394437 }, { 0.374517769 ,  -0.816000186 }, { 0.615856883 ,  -0.452289678 }, { 0.623870752 ,  -0.0800712325 }, { 0.465650961 ,  0.179866537 }}
        };

        double[][][] out = new double[result.length][result[0].length][2];
        for (int i=0; i<out_cplx.length; i++) {
            for (int j=0; j<out_cplx[0].length; j++) {
                out[i][j][0] = out_cplx[i][j].getReal();
                out[i][j][1] = out_cplx[i][j].getImaginary();
            }
        }

        for (int i=0; i<result.length; i++) {
            for (int j=0; j<result[0].length; j++) {
                Assertions.assertArrayEquals(result[i][j], out[i][j], 0.001);
            }
        }

    }

}
